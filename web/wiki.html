<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Lang Bot</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="title-container">
    <div class="title-pill">
<h1>Language Wiki</h1>
    </div>
    </div>
<div class="intro">
<p>This is an interactive webpage that can allow you to find languages that match queries related to things like name, language family, language branch, script, number of speakers and number of countries spoken for languages with over 50 million speakers. <br> (If the results are an empty list, this means the query you inputted either doesn't exist, doesn't have results, or is not relevant to languages with over 50 million speakers)</p>
    </div>
<div class="containers">
    <div class="form-section">
<h2>Enter a language name:</h2>

<form id="lang_form">
    <div class="input-group">
        <label for="lang">Language:</label>
        <input id="lang" name="lang" type="text" placeholder="Name"/>
    </div>
    <button type="submit" value="lang" class="submit">Submit</button>
</form>
<h4>Languages that match your query: </h4>

<pre id="lang_response"></pre>
        </div>
    <div class="form-section">
<h2>Select a language family:</h2>
<form id="family_form">
    <div class="input-group">
        <label for="family">Family: </label>
        <select id="family" name="family">
            <option disabled selected>--Select--</option>
            <option value="Afro-Asiatic">Afro-Asiatic</option>
            <option value="Austroasiatic">Austroasiatic</option>
            <option value="Austronesian">Austronesian</option>
            <option value="Dravidian">Dravidian</option>
            <option value="Indo-European">Indo-European</option>
            <option value="Japonic">Japonic</option>
            <option value="Koreanic">Koreanic</option>
            <option value="Kra-Dai">Kra-Dai</option>
            <option value="Niger-Congo">Niger-Congo</option>
            <option value="Sino-Tibetan">Sino-Tibetan</option>
            <option value="Turkic">Turkic</option>
        </select>
    </div>
    <button type="submit" value="family">Submit</button>
</form>
<h4>Languages that match your query: </h4>
<pre id="family_response"></pre>
    </div>

        <div class="form-section">
<h2>Select a language family:</h2>
<form id="branch_form">
    <div class="input-group">
        <label for="branch">Branch: </label>
        <select id="branch" name="branch">
            <option disabled selected>--Select--</option>
            <option value="Balto-Slavic">Balto-Slavic</option>
            <option value="Bantu">Bantu</option>
            <option value="Chadic">Chadic</option>
            <option value="Germanic">Germanic</option>
            <option value="Indo-Aryan">Indo-Aryan</option>
            <option value="Iranian">Iranian</option>
            <option value="Malayo-Polynesian">Malayo-Polynesian</option>
            <option value="Romance">Romance</option>
            <option value="Semitic">Semitic</option>
            <option value="Sinitic">Sinitic</option>
            <option value="South">South (Indic Languages)</option>
            <option value="South-Central">South-Central (Indic Languages)</option>
            <option value="Vietic">Vietic</option>
            <option value="Zhuang-Tai">Zhuang-Tai</option>


        </select>
    </div>
    <button type="submit" value="family">Submit</button>
</form>
<h4>Languages that match your query: </h4>
<pre id="branch_response"></pre>
    </div>
    <div class="form-section">
<h2>Select a script:</h2>
<form id="script_form">
    <div class="input-group">
        <label for="script">Script: </label>
        <select id="script" name="script">
            <option disabled selected>--Select--</option>
            <option value="Arabic">Arabic</option>
            <option value="Baybayin">Baybayin</option>
            <option value="Bengali">Bengali</option>
            <option value="Chinese">Chinese</option>
            <option value="Cyrillic">Cyrillic</option>
            <option value="Devanagari">Devanagari</option>
            <option value="Gujarati">Gujarati</option>
            <option value="Gurmukhi">Gurmukhi</option>
            <option value="Hangul">Hangul</option>
            <option value="Javanese">Javanese</option>
            <option value="Kana">Kana</option>
            <option value="Kannada">Kannada</option>
            <option value="Latin">Latin</option>
            <option value="Saba">Saba</option>
            <option value="Syriac">Syriac</option>
            <option value="Tamil">Tamil</option>
            <option value="Telugu">Telugu</option>
            <option value="Thai">Thai</option>

        </select>
    </div>
    <button type="submit" value="script">Submit</button>
</form>
        <h4>Languages that match your query:</h4>
<pre id="script_response"></pre>
    </div>
    <div class="form-section">
        <h2>Enter range for speakers in millions:</h2>
        <p><small>Note: numbers range from 50 to 1,528</small></p>
        <form id="speakers_form">
            <div class="input-group">
        <label for="min"></label>
        <input id="min" name="min" type="number" placeholder="Min"/>
                <label for="max"></label>
        <input id="max" name="max" type="number" placeholder="Max"/>
    </div>
    <button type="submit" value="speakers" class="submit">Submit</button>
        </form>
                <h4>Languages that match your query:</h4>
<pre id="speakers_response"></pre>

    </div>
    <div class="form-section">
        <h3>Enter range of countries where this language is spoken:</h3>
         <p><small>Note: numbers range from 1 to 75</small></p>
        <form id="countries_form">
            <div class="input-group">
        <label for="min1"></label>
        <input id="min1" name="min1" type="number" placeholder="Min"/>
                <label for="max1"></label>
        <input id="max1" name="max1" type="number" placeholder="Max"/>
    </div>
    <button type="submit" value="countries" class="submit">Submit</button>
        </form>
                <h4>Languages that match the query:</h4>
<pre id="countries_response"></pre>

    </div>
</div>
<script>
    function titleCase(word) {
  return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();
}

   function attachFormHandler(formId, fieldName, endpoint, outputId) {
    const form = document.getElementById(formId);

    form.addEventListener("submit", async function(event) {
        event.preventDefault();

        const data = new FormData(form);
        const value = titleCase(data.get(fieldName));

        try {
            const response = await fetch(`http://localhost:5000${endpoint}?${fieldName}=${encodeURIComponent(value)}`, {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' }
            });
            const myJson = await response.json();
            document.getElementById(outputId).textContent = JSON.stringify(myJson, null, 2);
        } catch (err) {
            document.getElementById(outputId).textContent = "Error: " + err;
        }
    })
    }
    function attachFormHandler2(formId, param1, param2, endpoint, outputId) {
    const form = document.getElementById(formId);

    form.addEventListener("submit", async function(event) {
        event.preventDefault();
        min = parseFloat(document.getElementById(param1).value);
        max = parseFloat(document.getElementById(param2).value);

        try {
            const response = await fetch(`http://localhost:5000${endpoint}?${param1}=${min}&${param2}=${max}`, {
                method: 'GET',
                headers: { 'Content-Type': 'application/json' }
            });
            const myJson = await response.json();
            document.getElementById(outputId).textContent = JSON.stringify(myJson, null, 2);
        } catch (err) {
            document.getElementById(outputId).textContent = "Error: " + err;
        }
    });
    }

    attachFormHandler("lang_form", "lang", "/search_lang", "lang_response")
    attachFormHandler("family_form", "family", "/search_family", "family_response")
    attachFormHandler("branch_form", "branch", "/search_branch", "branch_response")
    attachFormHandler("script_form", "script", "/search_script", "script_response")
    attachFormHandler2("speakers_form", "min", "max", "/search_speakers", "speakers_response")
    attachFormHandler2("countries_form", "min1", "max1", "/search_countries", "countries_response")
</script>
</body>
</html>